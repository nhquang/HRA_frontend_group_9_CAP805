{"remainingRequest":"C:\\Users\\Akash\\Desktop\\College\\2nd Semester\\CAP 805 Capstone Project\\HRA_frontend_group_9_CAP805\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Akash\\Desktop\\College\\2nd Semester\\CAP 805 Capstone Project\\HRA_frontend_group_9_CAP805\\src\\components\\department\\list.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Akash\\Desktop\\College\\2nd Semester\\CAP 805 Capstone Project\\HRA_frontend_group_9_CAP805\\src\\components\\department\\list.vue","mtime":1628681336470},{"path":"C:\\Users\\Akash\\Desktop\\College\\2nd Semester\\CAP 805 Capstone Project\\HRA_frontend_group_9_CAP805\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Akash\\Desktop\\College\\2nd Semester\\CAP 805 Capstone Project\\HRA_frontend_group_9_CAP805\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYnJhbmNoSWQ6JycsCiAgICAgIG1hc3Rlcl9icmFuY2hlczogW10sCiAgICAgIGxpc3Q6IFtdLAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgZ2V0QnJhbmNoKCl7CiAgICAgIHZhciByZXNwb25zZSA9IGF3YWl0IGF4aW9zLmdldCh0aGlzLiRzdG9yZS5zdGF0ZS5hcGlVcmwrIi9icmFuY2hlcyIsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAnQmVhcmVyICcrIHRoaXMuJGNvb2tpZXMuZ2V0KCdfdF9ocm0nKQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGlmKHJlc3BvbnNlLmhhc093blByb3BlcnR5KCdkYXRhJykpIHsKICAgICAgICB0aGlzLm1hc3Rlcl9icmFuY2hlcyA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdGhpcy5icmFuY2hJZCA9IHRoaXMubWFzdGVyX2JyYW5jaGVzWzBdLl9pZDsKICAgICAgfQogICAgfSwKICAgIGFkZERlcGFydG1lbnQoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvZGVwYXJ0bWVudC9hZGQnKTsKICAgIH0sCiAgICBlZGl0RGVwYXJ0bWVudChpZCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL2RlcGFydG1lbnQvZWRpdC8nK2lkKTsKICAgIH0sCiAgICBhc3luYyBkZWxldGVEZXBhcnRtZW50KGlkLCBpbmRleCkgewogICAgICB2YXIgY29uZmlybSA9IGF3YWl0IHRoaXMuJGNvbmZpcm0oJ0FyZSB5b3Ugc3VyZSB0byBkZWxldGU/Jyk7CiAgICAgIGlmKGNvbmZpcm0pIHsgCiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgdmFyIHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZGVsZXRlKHRoaXMuJHN0b3JlLnN0YXRlLmFwaVVybCsnL2RlcGFydG1lbnRzLycraWQsIHsKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJysgdGhpcy4kY29va2llcy5nZXQoJ190X2hybScpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgaWYocmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ2RhdGEnKSkgewogICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLmhhc093blByb3BlcnR5KCdtZXNzYWdlJykgJiYgcmVzcG9uc2UuZGF0YS5tZXNzYWdlICE9ICcnKSB7CiAgICAgICAgICAgICAgdGhpcy4kdG9hc3RlcihyZXNwb25zZS5kYXRhLm1lc3NhZ2UpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJGRlbGV0ZSh0aGlzLmxpc3QsIGluZGV4KTsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICB9CiAgICAgICAgY2F0Y2goZXJyb3IpIHsKICAgICAgICAgIHRoaXMuJGVycm9ySGFuZGxpbmcoZXJyb3IpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFzeW5jIGdldEJyYW5jaERlcGFydG1lbnQoKXsKICAgICAgdmFyIHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLmFwaVVybCsnL2RlcGFydG1lbnRzP2JyYW5jaElkPScrdGhpcy5icmFuY2hJZCwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJysgdGhpcy4kY29va2llcy5nZXQoJ190X2hybScpCiAgICAgICAgfQogICAgICB9KTsKICAgICAgaWYocmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ2RhdGEnKSkgewogICAgICAgIHRoaXMubGlzdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0KICAgIH0KICB9LAogIGFzeW5jIGNyZWF0ZWQoKSB7CiAgICB0cnkgewogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5sb2FkaW5nID0gdHJ1ZTsKICAgICAgYXdhaXQgdGhpcy5nZXRCcmFuY2goKTsKICAgICAgdmFyIHJlc3BvbnNlID0gYXdhaXQgYXhpb3MuZ2V0KHRoaXMuJHN0b3JlLnN0YXRlLmFwaVVybCsnL2RlcGFydG1lbnRzP2JyYW5jaElkPScrdGhpcy5icmFuY2hJZCwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIEF1dGhvcml6YXRpb246ICdCZWFyZXIgJysgdGhpcy4kY29va2llcy5nZXQoJ190X2hybScpCiAgICAgICAgfQogICAgICB9KTsKICAgICAgaWYocmVzcG9uc2UuaGFzT3duUHJvcGVydHkoJ2RhdGEnKSkgewogICAgICAgIHRoaXMubGlzdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgIH0KICAgICAgdGhpcy4kc3RvcmUuc3RhdGUubG9hZGluZyA9IGZhbHNlOwogICAgfQogICAgY2F0Y2goZXJyb3IpIHsKICAgICAgdGhpcy4kZXJyb3JIYW5kbGluZyhlcnJvcik7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/components/department","sourcesContent":["<template>\n  <div class=\"sm-page\">\n    <div class=\"sm-page-nav\">\n      <div class=\"row\">\n        <div class=\"col-6 px-2 my-auto\">\n          <p>Department</p>\n        </div>\n        <div class=\"col-6 d-flex justify-content-end\">\n          <div class=\"col-6 mb-auto pr-1\">\n              <select v-model=\"branchId\" id=\"branchId\" @change=\"getBranchDepartment()\">\n                <option value=\"\">--Select--</option>\n                <option v-for=\"(item, index) in master_branches\" :key=\"index\" :value=\"item._id\">{{ item.name }}</option>\n              </select>      \n            </div>\n          <button class=\"btn\" @click=\"addDepartment()\">\n            <i class=\"fa fa-plus-circle\"></i>\n            <span>Add</span>\n          </button>\n        </div>\n      </div>\n    </div>\n    <div class=\"sm-page-body b-0\">\n      <div class=\"table-grid\">\n        <table class=\"table\">\n          <thead>\n            <tr>\n              <td class=\"text-center\" style=\"width: 30px; min-width: 30px\">\n                #\n              </td>\n              <td style=\"min-width: 150px\">Name</td>\n              <!-- <td style=\"min-width: 150px\">Branch</td> -->\n              <td style=\"min-width: 150px\">Description</td>\n              <td></td>\n            </tr>\n          </thead>\n          <tbody>\n            <tr v-for=\"(item, index) in list\" :key=\"index\">\n              <td class=\"text-center\">{{ index + 1 }}</td>\n              <td>{{ item.name }}</td>\n              <!-- <td>{{ item.branchId }}</td> -->\n              <td>{{ item.description }}</td>\n              <td class=\"text-right\">\n                <a href=\"javascript:void(0)\" class=\"px-2 text-success\" @click=\"editDepartment(item._id)\">Edit</a>\n                <span>|</span>                \n                <a href=\"javascript:void(0)\" class=\"px-2 text-danger\" @click=\"deleteDepartment(item._id, index)\">Delete</a>\n              </td>\n            </tr>        \n          </tbody>\n        </table>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport axios from 'axios';\nexport default {\n  data() {\n    return {\n      branchId:'',\n      master_branches: [],\n      list: [],\n    }\n  },\n  methods: {\n    async getBranch(){\n      var response = await axios.get(this.$store.state.apiUrl+\"/branches\", {\n        headers: {\n          Authorization: 'Bearer '+ this.$cookies.get('_t_hrm')\n        }\n      });\n      if(response.hasOwnProperty('data')) {\n        this.master_branches = response.data;\n        this.branchId = this.master_branches[0]._id;\n      }\n    },\n    addDepartment() {\n      this.$router.push('/department/add');\n    },\n    editDepartment(id) {\n      this.$router.push('/department/edit/'+id);\n    },\n    async deleteDepartment(id, index) {\n      var confirm = await this.$confirm('Are you sure to delete?');\n      if(confirm) { \n        try {\n          this.$store.state.loading = true;\n          var response = await axios.delete(this.$store.state.apiUrl+'/departments/'+id, {\n            headers: {\n              Authorization: 'Bearer '+ this.$cookies.get('_t_hrm')\n            }\n          });\n          if(response.hasOwnProperty('data')) {\n            if(response.data.hasOwnProperty('message') && response.data.message != '') {\n              this.$toaster(response.data.message);\n            }\n            this.$delete(this.list, index);\n          }\n          this.$store.state.loading = false;\n        }\n        catch(error) {\n          this.$errorHandling(error);\n        }\n      }\n    },\n    async getBranchDepartment(){\n      var response = await axios.get(this.$store.state.apiUrl+'/departments?branchId='+this.branchId, {\n        headers: {\n          Authorization: 'Bearer '+ this.$cookies.get('_t_hrm')\n        }\n      });\n      if(response.hasOwnProperty('data')) {\n        this.list = response.data;\n      }\n    }\n  },\n  async created() {\n    try {\n      this.$store.state.loading = true;\n      await this.getBranch();\n      var response = await axios.get(this.$store.state.apiUrl+'/departments?branchId='+this.branchId, {\n        headers: {\n          Authorization: 'Bearer '+ this.$cookies.get('_t_hrm')\n        }\n      });\n      if(response.hasOwnProperty('data')) {\n        this.list = response.data;\n      }\n      this.$store.state.loading = false;\n    }\n    catch(error) {\n      this.$errorHandling(error);\n    }\n  }\n}\n</script>\n\n"]}]}